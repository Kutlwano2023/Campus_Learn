@using Microsoft.AspNetCore.Identity
@inject UserManager<Users> UserManager

@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h1 class="display-4">Welcome to CampusLearn</h1>
    <p class="lead">Your platform for connecting students and tutors.</p>

    @if (User.Identity.IsAuthenticated)
    {
        <div class="mt-4">
            <div class="alert alert-success">
                <h3>Welcome back!</h3>
                @{
                    var user = await UserManager.GetUserAsync(User);
                    var fullName = user?.FullName ?? User.Identity.Name;
                    var roles = await UserManager.GetRolesAsync(user);
                    var userRole = roles.FirstOrDefault() ?? user?.Role;
                }
                <p>You are logged in as: <strong>@fullName</strong></p>
                <p>Role: <strong>@userRole</strong></p>
            </div>

            <div class="mt-3">
                @if (userRole == "TUTOR")
                {
                    <a asp-controller="Portal" asp-action="TutorPortal" class="btn btn-primary btn-lg">Go to Tutor Portal</a>
                }
                else
                {
                    <a asp-controller="Portal" asp-action="StudentPortal" class="btn btn-primary btn-lg">Go to Student Portal</a>
                }
                <a asp-controller="Portal" asp-action="Dashboard" class="btn btn-outline-secondary btn-lg">Dashboard</a>
            </div>
        </div>
    }
    else
    {
        <div class="mt-4">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">For Students</h5>
                                    <p class="card-text">Access learning materials, connect with tutors, and track your progress.</p>
                                    <a asp-controller="Account" asp-action="Register" class="btn btn-primary">Join as Student</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">For Tutors</h5>
                                    <p class="card-text">Share your knowledge, schedule sessions, and help students succeed.</p>
                                    <a asp-controller="Account" asp-action="Register" class="btn btn-success">Join as Tutor</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-3">
                <p>Already have an account? <a asp-controller="Account" asp-action="Login" class="btn btn-outline-primary">Login</a></p>
            </div>
        </div>
    }
</div>